ArchivesSignView=Ext.extend(Ext.Panel,{constructor:function(a){Ext.applyIf(this,a);this.initUIComponents();ArchivesSignView.superclass.constructor.call(this,{id:"ArchivesSignView",title:"公文签收待办",region:"center",layout:"border",iconCls:"menu-archive-sign",items:[this.searchPanel,this.gridPanel]});},initUIComponents:function(){this.searchPanel=new Ext.FormPanel({height:35,region:"north",frame:false,border:false,layout:"hbox",layoutConfig:{padding:"5",align:"middle"},defaults:{style:"padding:0px 5px 0px 5px;",border:false,anchor:"98%,98%",labelWidth:75,xtype:"label"},items:[{text:"类型名称"},{name:"Q_typeName_S_LK",width:100,xtype:"textfield"},{text:"发文字号"},{width:100,name:"Q_archivesNo_S_LK",xtype:"textfield"},{text:"文件标题"},{width:100,name:"Q_subject_S_LK",xtype:"textfield"},{xtype:"button",text:"查询",iconCls:"search",handler:this.search.createCallback(this)},{xtype:"hidden",name:"Q_archives.archStatus_SN_EQ",value:1},{xtype:"hidden",name:"Q_archives.archType_SN_EQ",value:0}]});this.gridPanel=new HT.EditorGridPanel({region:"center",clicksToEdit:1,height:500,rowActions:true,id:"RegulationGrid",url:__ctxPath+"/archive/listArchivesDep.do",baseParams:{"Q_archives.archType_SN_EQ":0,"Q_archives.archStatus_SN_EQ":1,"Q_status_SN_EQ":0},fields:[{name:"archDepId",type:"int"},"archives"],columns:[{header:"archDepId",dataIndex:"archDepId",hidden:true},{header:"公文类型名称",dataIndex:"archives",renderer:function(a){return a.typeName;}},{header:"发文字号",dataIndex:"archives",renderer:function(a){return a.archivesNo;}},{header:"发文机关或部门",dataIndex:"archives",renderer:function(a){return a.issueDep;}},{header:"文件标题",dataIndex:"archives",renderer:function(a){return a.subject;}},{header:"公文状态",dataIndex:"archives",renderer:function(a){if(a!=null){return a.status;}else{return"办结";}}},{header:"秘密等级",dataIndex:"archives",renderer:function(a){return a.privacyLevel;}},{header:"紧急程度",dataIndex:"archives",renderer:function(a){return a.urgentLevel;}},{header:"发文时间",dataIndex:"archives",renderer:function(a){return a.createtime.substring(0,10);}},new Ext.ux.grid.RowActions({header:"管理",width:100,actions:[{iconCls:"btn-archives-detail",qtip:"查阅详情",style:"margin:0 3px 0 3px"},{iconCls:"btn-archive-sign",qtip:"公文签收",style:"margin:0 3px 0 3px"}],listeners:{scope:this,"action":this.onRowAction}})]});this.gridPanel.addListener("rowdblclick",this.rowClick);},reset:function(){this.searchPanel.getForm().reset();},search:function(){$search({searchPanel:this.searchPanel,gridPanel:this.gridPanel});},rowClick:function(b,a,c){},createRs:function(){},removeRs:function(a){},removeSelRs:function(){},editRs:function(a){},scanRs:function(a){new ArchivesDetailWin({archivesId:a.data.archives.archivesId,runId:a.data.archives.runId}).show();},signRs:function(a){var c=App.getContentPanel();var b=c.getItem("ProcessRunStart"+this.defId);if(b==null){b=new ProcessRunStart({id:"ProcessRunStart"+this.defId,defId:this.defId,flowName:this.flowName,vmParams:"{archivesId:"+a.data.archives.archivesId+",archDepId:"+a.data.archDepId+"}"});c.add(b);}c.activate(b);},onRowAction:function(c,a,d,e,b){switch(d){case"btn-archives-detail":this.scanRs.call(this,a);break;case"btn-archive-sign":this.signRs.call(this,a);break;default:break;}}});