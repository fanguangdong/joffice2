Portlet=Ext.extend(Ext.ux.Portlet,{tools:null,url:null,constructor:function(a){Ext.applyIf(this,a);this.initTool(a);if(a.sectionType==2){this.url=__ctxPath+"/pages/indexpages/deskNewsListPage.jsp?sectionId="+a.sectionId;}else{if(a.sectionType==3){this.url=__ctxPath+"/pages/indexpages/noticeScrollPage.jsp?sectionId="+a.sectionId;}else{this.url=__ctxPath+"/pages/indexpages/newsListPage.jsp?sectionId="+a.sectionId;}}Portlet.superclass.constructor.call(this,{title:a.title,iconCls:a.iconCls,tools:this.tools,autoLoad:{url:this.url,scripts:true}});},initTool:function(a){this.tools=[{id:"refresh",scope:this,handler:function(){this.getUpdater().update(this.url);}}];}});ComIndexPage=Ext.extend(Ext.Panel,{toolbar:null,constructor:function(a){Ext.applyIf(this,a);this.initUIComponents();ComIndexPage.superclass.constructor.call(this,{title:"公司主页",closable:false,id:"ComIndexPage",iconCls:"menu-company",layout:"fit",defaults:{padding:"0 5 0 0"},tbar:this.toolbar,items:[]});},initUIComponents:function(){this.toolbar=new Ext.Toolbar({height:30,items:[{iconCls:"btn-refresh",text:"刷新视图",xtype:"button",scope:this,handler:this.refreshRs.createCallback(this)}]});var a=[{id:"gear",handler:function(){Ext.Msg.alert("Message","The Settings tool was clicked.");}}];this.refreshRs(this);},refreshRs:function(a,d){a.removeAll(true);a.doLayout();var e=[];var c=[];var b=[];Ext.Ajax.request({url:__ctxPath+"/info/listSection.do",method:"POST",params:{"Q_status_SN_EQ":1},success:function(f){var h=Ext.util.JSON.decode(f.responseText);var j=h.result;if(d==null||d==undefined||d==""){d=h.columnType;}for(var g=0;g<h.totalCounts;g++){var l=j[g];if(d==1){e.push(new Portlet({title:l.sectionName,sectionId:l.sectionId,sectionType:l.sectionType}));}else{if(d==2){if(l.colNumber==1){e.push(new Portlet({title:l.sectionName,sectionId:l.sectionId,sectionType:l.sectionType}));}else{c.push(new Portlet({title:l.sectionName,sectionId:l.sectionId,sectionType:l.sectionType}));}}else{if(l.colNumber==1){e.push(new Portlet({title:l.sectionName,sectionId:l.sectionId,sectionType:l.sectionType}));}else{if(l.colNumber==2){c.push(new Portlet({title:l.sectionName,sectionId:l.sectionId,sectionType:l.sectionType}));}else{b.push(new Portlet({title:l.sectionName,sectionId:l.sectionId,sectionType:l.sectionType}));}}}}}var k=null;if(d==1){k=[{columnWidth:0.98,style:"padding:10px 0 10px 10px",name:"FirstColumn",items:e}];}else{if(d==2){k=[{columnWidth:0.64,style:"padding:10px 0 10px 10px",name:"FirstColumn",items:e},{columnWidth:0.35,style:"padding:10px 10px 10px 10px",items:c}];}else{k=[{columnWidth:0.33,style:"padding:10px 0 10px 10px",name:"FirstColumn",items:e},{columnWidth:0.33,style:"padding:10px 10px 10px 10px",items:c},{columnWidth:0.33,style:"padding:10px 0px 10px 0px",items:b}];}}a.add({xtype:"portal",region:"center",border:false,id:"IndexPortal",margins:"35 5 5 0",items:k});a.doLayout();},failure:function(){}});}});