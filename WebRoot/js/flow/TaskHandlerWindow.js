TaskHandlerWindow=Ext.extend(Ext.Window,{constructor:function(a){Ext.applyIf(this,a);this.initUIs();TaskHandlerWindow.superclass.constructor.call(this,{title:"为任务设置限期时间",height:120,width:350,layout:"fit",modal:true,items:this.formPanel,buttonAlign:"center",buttons:[{text:"保存",iconCls:"btn-save",scope:this,handler:this.save},{text:"关闭",iconCls:"btn-cancel",scope:this,handler:this.close}]});},initUIs:function(){this.formPanel=new Ext.form.FormPanel({layout:"form",modal:true,border:false,bodyStyle:"padding:4px",items:[{xtype:"hidden",name:"userId"},{xtype:"compositefield",fieldLabel:"指定人员",items:[{xtype:"textfield",name:"userName",allowBlank:false,anchor:"98%,98%"},{xtype:"button",text:"选择待办人员",scope:this,handler:this.selectUser}]}]});},selectUser:function(){var a=this.getCmpByName("userId");var b=this.getCmpByName("userName");UserSelector.getView(function(c,d){a.setValue(c);b.setValue(d);},true).show();},save:function(){var a=this.taskGrid?this.taskGrid:Ext.getCmp("allTaskGrid");var b=a.getSelectionModel().getSelections();var d="";for(var c=0;c<b.length;c++){if(c>0){d+=",";}d+=b[c].data.taskId;}if(this.formPanel.getForm().isValid()){this.formPanel.getForm().submit({scope:this,params:{taskIds:d},url:__ctxPath+"/flow/handlerTask.do",method:"POST",success:function(e,f){Ext.ux.Toast.msg("操作信息","成功更改待办人员!");a.getStore().reload();this.close();},failure:function(e,f){Ext.ux.Toast.msg("操作信息","操作失败，请联系管理员!");}});}}});