DocumentSharedForm=Ext.extend(Ext.Window,{formPanel:null,constructor:function(a){Ext.applyIf(this,a);this.initUI();DocumentSharedForm.superclass.constructor.call(this,{title:"文档授权信息",width:545,iconCls:"menu-mail_folder",height:380,modal:true,layout:"fit",plain:true,scope:this,minWidth:544,buttonAlign:"center",items:this.formPanel,buttons:this.buttons});},initUI:function(){this.formPanel=new Ext.FormPanel({id:"documentSharedForm",bodyStyle:"padding:4px 10px 4px 10px",items:[{xtype:"hidden",name:"docId",value:this.docId},{xtype:"fieldset",border:false,layout:"column",items:[{xtype:"label",text:"共享人员",width:100},{xtype:"hidden",name:"sharedUserIds",id:"sharedUserIds"},{xtype:"textarea",name:"sharedUserNames",id:"sharedUserNames",width:300},{xtype:"button",text:"选择",iconCls:"btn-select",width:80,handler:function(){UserSelector.getView(function(b,d){var a=Ext.getCmp("sharedUserIds");var e=Ext.getCmp("sharedUserNames");if(a.getValue()==""){a.setValue(","+b+",");e.setValue(d);return;}else{var f=a.getValue().split(",");var c=e.getValue().split(",");a.setValue(uniqueArray(f.concat(b.split(",")))+",");e.setValue(uniqueArray(c.concat(d.split(","))));}}).show();}},{xtype:"button",iconCls:"btn-clear",text:"清空",handler:function(){var a=Ext.getCmp("sharedUserIds");var b=Ext.getCmp("sharedUserNames");a.setValue("");b.setValue("");},width:80}]},{xtype:"fieldset",border:false,layout:"column",items:[{xtype:"label",text:"共享部门",width:100},{name:"sharedDepIds",id:"sharedDepIds",xtype:"hidden"},{name:"sharedDepNames",id:"sharedDepNames",xtype:"textarea",width:300},{xtype:"button",text:"选择",iconCls:"btn-select",width:80,handler:function(){DepSelector.getView(function(c,e){var b=Ext.getCmp("sharedDepIds");var d=Ext.getCmp("sharedDepNames");if(b.getValue()==""){b.setValue(","+c+",");d.setValue(e);return;}var f=b.getValue().split(",");var a=d.getValue().split(",");b.setValue(uniqueArray(f.concat(c.split(",")))+",");d.setValue(uniqueArray(a.concat(e.split(","))));}).show();}},{xtype:"button",text:"清空",iconCls:"btn-clear",handler:function(){var a=Ext.getCmp("sharedDepIds");var b=Ext.getCmp("sharedDepNames");a.setValue("");b.setValue("");},width:80}]},{xtype:"fieldset",border:false,layout:"column",items:[{xtype:"label",text:"共享角色",width:100},{xtype:"hidden",id:"sharedRoleIds",name:"sharedRoleIds"},{name:"sharedRoleNames",id:"sharedRoleNames",xtype:"textarea",width:300},{xtype:"button",text:"选择",iconCls:"btn-select",width:80,handler:function(){RoleSelector.getView(function(d,e){var a=Ext.getCmp("sharedRoleIds");var b=Ext.getCmp("sharedRoleNames");if(a.getValue()==""){a.setValue(","+d+",");b.setValue(e);return;}var f=a.getValue().split(",");var c=b.getValue().split(",");a.setValue(uniqueArray(f.concat(d.split(",")))+",");b.setValue(uniqueArray(c.concat(e.split(","))));}).show();}},{xtype:"button",text:"清空",iconCls:"btn-clear",handler:function(){var a=Ext.getCmp("sharedRoleIds");var b=Ext.getCmp("sharedRoleNames");a.setValue("");b.setValue("");},width:80}]}]});if(this.docId!=null&&this.docId!=""&&this.docId!="undefined"){this.formPanel.getForm().load({deferredRender:false,url:__ctxPath+"/document/getDocument.do?docId="+this.docId,waitMsg:"正在载入数据...",success:function(a,b){},failure:function(a,b){Ext.MessageBox.show({title:"操作信息",msg:"载入信息失败，请联系管理员！",buttons:Ext.MessageBox.OK,icon:"ext-mb-error"});}});}this.buttons=[{xtype:"button",text:"共享",scope:this,iconCls:"btn-ok",handler:function(){var a=this;this.formPanel.getForm().submit({url:__ctxPath+"/document/shareDocument.do",method:"post",waitMsg:"正在提交...",success:function(c,d){var b=Ext.getCmp("PrivateDocumentView");if(b!=null){b.dataView.getStore().reload();}a.close();}});}},{xtype:"button",text:"取消共享",scope:this,iconCls:"btn-cancel",handler:function(){var a=this;this.formPanel.getForm().submit({url:__ctxPath+"/document/unshareDocument.do",method:"post",waitMsg:"正在提交...",success:function(c,d){var b=Ext.getCmp("PrivateDocumentView");if(b!=null){b.dataView.getStore().reload();}a.close();}});}},{xtype:"button",iconCls:"btn-cancel",text:"关闭",scope:this,handler:function(){this.close();}}];}});