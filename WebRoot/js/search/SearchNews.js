Ext.ns("SearchNews");var SearchNews=function(a){return this.getView(a);};SearchNews.prototype.getView=function(a){return new Ext.Panel({id:"SearchNews",title:"搜索新闻",iconCls:"menu-news",border:false,style:"padding-bottom:10px;",autoScroll:true,items:[{region:"center",anchor:"100%",items:[new Ext.FormPanel({id:"ALLNewsSearchForm",height:40,frame:false,border:false,layout:"hbox",layoutConfig:{padding:"5",align:"middle"},defaults:{xtype:"label",margins:{top:0,right:4,bottom:4,left:4}},items:[{text:"请输入条件:"},{xtype:"textfield",name:"searchContent",width:150},{xtype:"button",text:"查询",iconCls:"search",handler:function(){var b=Ext.getCmp("ALLNewsSearchForm");var c=Ext.getCmp("SearchNewsGrid");if(b.getForm().isValid()){$search({searchPanel:b,gridPanel:c});}}},{xtype:"button",text:"重置",iconCls:"reset",handler:function(){var b=Ext.getCmp("ALLNewsSearchForm");b.getForm().reset();}},{name:"isNotice",value:0,xtype:"hidden"}]}),this.setup(a)]}]});};SearchNews.prototype.setup=function(a){return this.grid(a);};SearchNews.prototype.grid=function(d){var a=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer(),{header:"newsId",dataIndex:"newsId",hidden:true},{header:"新闻标题",width:120,dataIndex:"subject"},{header:"作者",width:120,dataIndex:"author"},{header:"创建时间",dataIndex:"createtime",renderer:function(e){if(e!=null){return e.substring(0,10);}}},{header:"回复次数",width:120,dataIndex:"replyCounts"},{header:"浏览数",width:120,dataIndex:"viewCounts"},{header:"状态",width:120,dataIndex:"status",renderer:function(e){if(e!=null&&e==0){return'<font color="red">禁用</font>';}else{if(e==1){return'<font color="green">激活</font>';}}}}],defaults:{sortable:true,menuDisabled:false,width:100}});var b=this.store();b.load({params:{start:0,limit:7,searchContent:d}});var c=new Ext.grid.GridPanel({id:"SearchNewsGrid",store:b,trackMouseOver:true,disableSelection:false,autoScroll:true,loadMask:true,autoHeight:true,sortable:false,cm:a,viewConfig:{forceFit:true,enableRowBody:false,showPreview:false},bbar:new HT.PagingBar({store:b,pageSize:7})});c.addListener("rowdblclick",function(g,f,h){g.getSelectionModel().each(function(e){App.clickTopTab("NewsDetail",e.data.newsId,function(){AppUtil.removeTab("NewsDetail");});});});return c;};SearchNews.prototype.store=function(){var a=new Ext.data.Store({baseParams:{"isNotice":0},proxy:new Ext.data.HttpProxy({url:__ctxPath+"/info/searchNews.do"}),reader:new Ext.data.JsonReader({root:"result",totalProperty:"totalCounts",id:"id",fields:[{name:"newsId",type:"int"},"sectionId","subjectIcon","subject","author","createtime","expTime","replyCounts","viewCounts","issuer","content","updateTime","status","isDeskImage","isNotice","sn","section"]}),remoteSort:true});a.setDefaultSort("newsId","desc");return a;};