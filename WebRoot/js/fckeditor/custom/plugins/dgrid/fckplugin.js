FCKCommands.RegisterCommand("dgrid",new FCKDialogCommand("dgrid",FCKLang.DgridProp,FCKPlugins.Items["dgrid"].Path+"fck_dgrid.html?Parent2",440,160));var oSItem=new FCKToolbarButton("dgrid",FCKLang.DgridButton);oSItem.IconPath=FCKPlugins.Items["dgrid"].Path+"grid.png";FCKToolbarItems.RegisterItem("dgrid",oSItem);FCKSelection.IsFormNode=function(){var b=this.GetSelectedElement();if(!b&&FCK.EditorWindow){try{b=this.GetSelection().getRangeAt(0).startContainer;}catch(a){}}while(b){if(b.nodeType==1&&b.nodeName.IEquals("TABLE")){if(b.getAttribute("isgrid")=="false"){return true;}return false;}b=b.parentNode;if(!b){break;}}return false;};FCKSelection.GetTableType=function(){var b=this.GetSelectedElement();if(!b&&FCK.EditorWindow){try{b=this.GetSelection().getRangeAt(0).startContainer;}catch(a){}}while(b){if(b.nodeType==1&&b.nodeName.IEquals("TABLE")){if(b.getAttribute("isgrid")=="true"){return"grid";}else{if(b.getAttribute("isgrid")=="false"){return"form";}else{return"table";}}}b=b.parentNode;if(!b){break;}}return"table";};FCK.ContextMenu.RegisterListener({AddItems:function(h,a,d){var c=(d=="TABLE");var f=FCKSelection.IsGridNode();var b=(!c&&FCKSelection.HasAncestorNode("TABLE")&&f);var e=FCKSelection.GetTableType();if(b){h.AddSeparator();var g=h.AddItem("Cell",FCKLang.CellCM);if(e=="form"){g.AddItem("TableInsertCellBefore",FCKLang.InsertCellBefore,69);g.AddItem("TableInsertCellAfter",FCKLang.InsertCellAfter,58);g.AddItem("TableDeleteCells",FCKLang.DeleteCells,59);if(FCKBrowserInfo.IsGecko){g.AddItem("TableMergeCells",FCKLang.MergeCells,60,FCKCommands.GetCommand("TableMergeCells").GetState()==FCK_TRISTATE_DISABLED);}else{g.AddItem("TableMergeRight",FCKLang.MergeRight,60,FCKCommands.GetCommand("TableMergeRight").GetState()==FCK_TRISTATE_DISABLED);}g.AddItem("TableHorizontalSplitCell",FCKLang.HorizontalSplitCell,61,FCKCommands.GetCommand("TableHorizontalSplitCell").GetState()==FCK_TRISTATE_DISABLED);g.AddSeparator();}g.AddItem("TableCellProp",FCKLang.CellProperties,57,FCKCommands.GetCommand("TableCellProp").GetState()==FCK_TRISTATE_DISABLED);if(e=="form"){h.AddSeparator();g=h.AddItem("Row",FCKLang.RowCM);g.AddItem("TableInsertRowBefore",FCKLang.InsertRowBefore,70);g.AddItem("TableInsertRowAfter",FCKLang.InsertRowAfter,62);g.AddItem("TableDeleteRows",FCKLang.DeleteRows,63);}h.AddSeparator();g=h.AddItem("Column",FCKLang.ColumnCM);g.AddItem("TableInsertColumnBefore",FCKLang.InsertColumnBefore,71);g.AddItem("TableInsertColumnAfter",FCKLang.InsertColumnAfter,64);g.AddItem("TableDeleteColumns",FCKLang.DeleteColumns,65);}if(c||b){h.AddSeparator();h.AddItem("TableDelete",FCKLang.TableDelete);h.AddItem("dgrid",FCKLang.DgridProp,FCKToolbarItems.GetItem("dgrid").IconPath);}}});