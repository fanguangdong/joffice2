var FckToolbarTemplateCombo=function(a,b){if(a===false){return;}this.CommandName="dtemplates";this.Label=this.GetLabel();this.Tooltip=a?a:this.Label;this.Style=b?b:2;this.DefaultLabel="";};FckToolbarTemplateCombo.prototype=new FCKToolbarSpecialCombo;FckToolbarTemplateCombo.prototype.GetLabel=function(){return FCKLang.Template;};FckToolbarTemplateCombo.prototype.getTemplates=function(){LoadTemplatesXml();return FCK._DTemplates;};FckToolbarTemplateCombo.prototype.CreateItems=function(a){var e=a._Panel.Document;FCKTools.AppendStyleSheet(e,FCKConfig.ToolbarComboPreviewCSS);FCKTools.AppendStyleString(e,FCKConfig.EditorAreaStyles);e.body.className+=" ForceBaseFont";FCKConfig.ApplyBodyAttributes(e.body);var d=this.getTemplates();for(var c=0;c<d.length;c++){var b=d[c];a.AddItem(c,b.Title,b.Title);}};FckToolbarTemplateCombo.prototype.RefreshActiveItems=function(a){a.SetLabel(this.DefaultLabel);};function LoadTemplatesXml(){var e;if(!FCK._DTemplates){FCK._DTemplates=new Array();var f=new FCKXml();f.LoadUrl(FCKConfig.DTemplatesXmlPath);var d=f.SelectSingleNode("Templates/@imagesBasePath");var g=d?d.value:"";var a=f.SelectNodes("Templates/Template");for(var b=0;b<a.length;b++){var h=a[b];e=new Object();var c;if((c=h.attributes.getNamedItem("title"))){e.Title=c.value;}else{e.Title="Template "+(b+1);}if((c=f.SelectSingleNode("Description",h))){e.Description=c.text?c.text:c.textContent;}if((c=h.attributes.getNamedItem("image"))){e.Image=g+c.value;}if((c=f.SelectSingleNode("Html",h))){e.Html=c.text?c.text:c.textContent;}else{alert("No HTML defined for template index "+b+'. Please review the "'+FCKConfig.TemplatesXmlPath+'" file.');continue;}FCK._DTemplates[FCK._DTemplates.length]=e;}}}var FckTemplateCommand=function(){};FckTemplateCommand.prototype={Name:"dtemplates",Execute:function(a,b){FCKUndo.SaveUndoStep();FCK.SetData(FCK._DTemplates[a].Html);},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorDocument){return -1;}return 0;}};FCKCommands.RegisterCommand("dtemplates",new FckTemplateCommand());FCKToolbarItems.RegisterItem("dtemplates",new FckToolbarTemplateCombo());